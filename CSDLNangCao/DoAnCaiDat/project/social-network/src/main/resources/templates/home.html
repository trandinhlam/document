<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="description" content="" />
  <meta name="author" content="" />

  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

  <link href="https://fonts.googleapis.com/css?family=Lato:100,300,400,700,900" rel="stylesheet" />

  <title>User Profile</title>
  
  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Additional CSS Files -->
  <link rel="stylesheet" href="assets/css/fontawesome.css" />
  <link rel="stylesheet" href="assets/css/templatemo-style.css" />
  <link rel="stylesheet" href="assets/css/owl.css" />
  <link rel="stylesheet" href="assets/css/lightbox.css" />
  <link rel="stylesheet" href="assets/css/custom.css" />
</head>

<body>
  <div id="page-wraper">
    <div class="row">
      <div class="col-md-1"></div>
      <div class="col-md-5" style="margin-top: 20mm">
<!--    Content for newfeed-->
          <div class="form-group">
            <textarea name="content" id="editor" style="resize: none!important;width: 100%; height: 60mm!important;"></textarea>
          </div>
          <div style="text-align: right">
            <button type="submit" class="btn btn-primary"  id="post-bai">Đăng bài</button>
          </div>
        <hr style="height: 1px;background: white">
        <h2 style="text-align: center; color: white">Tin mới</h2>
        <div id="newFeedSection" style="height:200mm; overflow: auto;">
          <div th:each ="post : ${newFeed}" class="isotope-box">
            <div style="padding: 2mm 6mm 2mm 6mm;background: #cbd3da;border-radius: 5px; margin: 2mm ;word-wrap: break-word;">
            <b th:utext="${post.owner.name}"></b>
              <span style="font-size: 8pt;float:right" th:utext="${#dates.format(post.dateCreated, 'dd-MMM-yyyy hh:mm:ss')}"></span>
              <hr style="height: 1px;background: #2e4d84;padding: 0 2mm 0 2mm;padding-top: 0; margin-top: 0">
              <div>
                [(${post.content})]
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <section class="section my-work" data-section="section2">
          <div class="container">
            <div class="section-heading">
              <h2>Gợi Ý Dành Cho Bạn</h2>
              <div class="line-dec"></div>
              <span>Những người bạn có thể quan tâm</span>
            </div>
            <div class="isotope-wrapper">
              <div th:each ="user : ${suggestedUsers}" class="isotope-box">

                <div class="isotope-item" data-type="nature">
                  <figure class="snip1321">
                    <img th:src="${user.avatar}" alt="sq-sample26" />
                    <figcaption>
                      <a th:href="${user.avatar}" data-lightbox="image-1"><i class="fa fa-expand"></i></a>
                      <a th:href="${user.avatar}"><i class="fa fa-info-circle"></i></a>
                      <h4 th:utext="${user.name}"></h4>
                      <span th:utext="${user.city}"></span>
                    </figcaption>
                  </figure>
                </div>

              </div>
            </div>

          </div>
        </section>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <script src="assets/js/isotope.min.js"></script>
  <script src="assets/js/owl-carousel.js"></script>
  <script src="assets/js/lightbox.js"></script>
  <script src="assets/js/custom.js"></script>

<!--  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>-->
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>

  <script>
    tinymce.init({
      selector: 'textarea#editor',
      plugins: "textcolor",
      toolbar: "undo redo | styleselect | fontsizeselect | bold italic | alignleft aligncenter alignright alignjustify | outdent indent| forecolor backcolor",
      menubar: false,
      fontsize_formats: "8pt 10pt 12pt 14pt 18pt 24pt 36pt",
      content_style: "body {font-size: 14pt;color:black;}",
    });
  </script>
</body>
  <script>
    //according to loftblog tut
    $(".main-menu li:first").addClass("active");

    var showSection = function showSection(section, isAnimate) {
      var direction = section.replace(/#/, ""),
        reqSection = $(".section").filter(
          '[data-section="' + direction + '"]'
        ),
        reqSectionPos = reqSection.offset().top - 0;

      if (isAnimate) {
        $("body, html").animate(
          {
            scrollTop: reqSectionPos
          },
          800
        );
      } else {
        $("body, html").scrollTop(reqSectionPos);
      }
    };

    var checkSection = function checkSection() {
      $(".section").each(function () {
        var $this = $(this),
          topEdge = $this.offset().top - 80,
          bottomEdge = topEdge + $this.height(),
          wScroll = $(window).scrollTop();
        if (topEdge < wScroll && bottomEdge > wScroll) {
          var currentId = $this.data("section"),
            reqLink = $("a").filter("[href*=\\#" + currentId + "]");
          reqLink
            .closest("li")
            .addClass("active")
            .siblings()
            .removeClass("active");
        }
      });
    };

    $(".main-menu").on("click", "a", function (e) {
      e.preventDefault();
      showSection($(this).attr("href"), true);
    });

    $(window).scroll(function () {
      checkSection();
    });
  </script>
  <script>
    $("#post-bai").click(function () {
        var postContent = tinyMCE.activeEditor.getContent();;
        var enpoint = "http://localhost:8080/api/post";
        $.ajax({
          url: enpoint,
          contentType: "application/json",
          type: 'POSt',
          dataType: 'json',
          data : JSON.stringify({
                    content : postContent
                  }),
          success: function (result) {
            location.reload();
          },
          error: function (xhr, textStatus, errorThrown) {
            location.reload();
          }
        });
    });
  </script>
  </body>

</html>